
	<h1>ORDER INFORMATION</h1>

	<form id="frm_order" name="frm_order" method="post" action="/customer/order/new">
	<input type="hidden" name="do" value="save"/>

	<table>
		<tr>
			<td>
			<label for="ordernumber" class="small_title">Order Number:</label><input type="text" id="ordernumber" name="ordernumber" class="auto_width" size="8"/><input type="button" class="submit rounded5" value="CONSOLIDATE"/><input type="checkbox" class="checkbox" id="combine" value="combine"/><label for="combine">Combine</label>
			</td>
			<td>
			<input type="checkbox" class="checkbox" id="freightch" value="freightch"/><label for="freightch">Freight Charges</label>
			<input type="checkbox" class="checkbox" id="cod" value="cod"/><label for="cod">COD</label>
			<input type="checkbox" class="checkbox" id="collect" value="collect"/><label for="collect">Collect</label>
			<input type="checkbox" class="checkbox" id="thirdp" value="thirdp"/><label for="thirdp">3rd Party</label>
			</td>
		<tr>
	</table>

	<table>
		<tr>
			<td>
			<table class="app">
				<caption>SHIP FROM</caption>
				<tr>
					<td><label for="fromname" class="float_right">Company:</label></td><td><input type="text" name="fromname" id="fromname" value="[% customer.customername %]" readonly/></td>
				</tr>
				<tr>
					<td><label for="fromaddress1" class="float_right">Address 1:</label></td><td><input type="text" name="fromaddress1" id="fromaddress1" value="[% customerAddress.address1 %]" readonly/></td>
				</tr>
				<tr>
					<td><label for="fromaddress2" class="float_right">Address 2:</label></td><td><input type="text" name="fromaddress2" id="fromaddress2" value="[% customerAddress.address2 %]" readonly/></td>
				</tr>
				<tr>
					<td><label for="fromcity" class="float_right">City:</label></td><td><input type="text" name="fromcity" id="fromcity" value="[% customerAddress.city %]" readonly/></td>
				</tr>
				<tr>
					<td><label for="fromstate" class="float_right">State:</label></td><td><input type="text" name="fromstate" id="fromstate" value="[% customerAddress.state %]" readonly/></td>
				</tr>
				<tr>
					<td><label for="fromzip" class="float_right">Zipcode:</label></td><td><input type="text" name="fromzip" id="fromzip" value="[% customerAddress.zip %]" readonly size="6" maxlength="5"/></td>
				</tr>
				<tr>
					<td><label for="fromcountry" class="float_right">Country:</label></td><td><input type="text" name="fromcountry" id="fromcountry" value="[% customerAddress.country %]" readonly/></td>
				</tr>
				<tr>
					<td><label for="fromcontact" class="float_right">Contact:</label></td><td><input type="text" class="text" name="fromcontact" id="fromcontact" value="[% customer.contact %]" readonly/></td>
				</tr>
				</tr>
					<td><label for="fromphone" class="float_right">Phone:</label></td><td><input type="text" class="text" name="fromphone" id="fromphone" value="[% customer.phone %]" readonly/></td>
				<tr>
				</tr>
					<td><label for="fromdepartment" class="float_right">Department:</label></td><td><input type="text" class="text" name="fromdepartment" id="fromdepartment"></td>
				<tr>
				<tr>
					<td><label for="fromemail" class="float_right">Email:</label></td><td><input type="text" class="text" name="fromemail" id="fromemail"/></td>
				</tr>
			</table>
			</td>
			<td>
			<table class="app">
				<caption>SHIP TO</caption>
				<tr>
					<td><label for="toname" class="float_right">Company: </label></td><td><input type="text" name="toname" id="toname"/></td>
				</tr>
				<tr>
					<td><label for="toaddress1" class="float_right">Address 1:</label></td><td><input type="text" class="text" name="toaddress1" id="toaddress1"/></td>
				</tr>
				<tr>
					<td><label for="toaddress2" class="float_right">Address 2:</label></td><td><input type="text" class="text" name="toaddress2" id="toaddress2"/></td>
				</tr>
				<tr>
					<td><label for="tocity" class="float_right">City:</label></td><td><input type="text" class="text" name="tocity" id="tocity"/></td><td></td>
				</tr>
				<tr>
					<td><label for="tostate" class="float_right">State:</label></td><td>
					<label>
					<select name="tostate" id="tostate">
						[% FOREACH item IN statelist_loop %]
							<option value="[% item.value %]">[% item.name %]</option>
						[% END %]
					</select>
					</label>
					</td>
				</tr>
				<tr>
					<td><label for="tozip" class="float_right">Zipcode:</label></td><td><input type="text" name="tozip" id="tozip" size="6" maxlength="5"/></td>
				</tr>
				<tr>
					<td><label for="tocountry" class="float_right">Country:</label></td><td>
					<label>
					<select name="tocountry" id="tocountry"/>
						[% FOREACH item IN countrylist_loop %]
								<option value="[% item.value %]">[% item.name %]</option>
						[% END %]
					</select>
					</label>
					</td>
				</tr>
				<tr>
					<td><label for="tocontact" class="float_right">Contact:</label></td><td><input type="text" class="text" name="tocontact" id="tocontact"/></td>
				</tr>
				<tr>
					<td><label for="tophone" class="float_right">Phone:</label></td><td><input type="text" name="tophone" id="tophone"></td>
				</tr>
				<tr>
					<td><label for="tocustomernumber" class="float_right">Customer Number:</label></td><td><input type="text" name="tocustomernumber" id="tocustomernumber"/></td>
				</tr>
				<tr>
					<td><label for="toemail" class="float_right">Email:</label></td><td><input type="text" name="toemail" id="toemail"/></td>
				</tr>
			</table>
			</td>
			<td>
			<table class="app">
				<caption>SHIPMENT INFORMATION</caption>
				<tr>
					<td><label for="shipon" class="float_right bold_text">Ship On:</label></td><td><input type="text" class="datefield" name="shipon" id="shipon"/></td>
				</tr>
				<tr>
					<td><label for="deliverby" class="float_right">Deliver By:</label></td><td><input type="text" class="text" name="deliverby" id="deliverby"/></td>
				</tr>
				<tr>
					<td><label for="comments" class="float_right">Comments:</label></td><td><input type="text" class="text" name="comments" id="comments"/></td>
				</tr>
				<tr>
					<td><label for="shipmentvalue" class="float_right">Shipment Value:</label></td><td><input type="text" class="text" name="shipmentvalue" id="shipmentvalue" value="0.00" readonly/></td>
				</tr>
				<tr>
					<td><label for="dryicewt" class="float_right">Dry Ice Wt:</label></td><td><input type="text" class="text" name="dryicewt" id="dryicewt"/></td>
				</tr>
				<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
				<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
				<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
				<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
				<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
				<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
				<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
				<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
				<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
				<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
			</table>
			</td>
		</tr>
	</table>

	<h2>Package Detail</h2>
	<label>Total Weight:</label><input type="text" name="totalweight" id="totalweight" class="bold_text" value="0.00" size="5" readonly />
	<label>Total Packages:</label><input type="text" name="totalweight" id="totalpackages" class="bold_text" value="0" size="5" readonly />
	<label for="insurance">Declared Value:</label><input type="text" name="insurance" id="insurance" value="0.00" size="5" readonly/>
	<label for="freightinsurance">Freight Insurance:</label><input type="text" name="freightinsurance" id="freightinsurance" value="0.00" size="5" readonly/>

	<table class="app">
		<tr>
			<th>QTY</th>
			<th>SKU</th>
			<th>Description</th>
			<th>Type</th>
			<th>Weight</th>
			<th>Dim Weight</th>
			<th>Length</th>
			<th>Width</th>
			<th>Height</th>
			<th>Density</th>
			<th>NMFC</th>
			<th>Class</th>
			<th>Declared Val</th>
			<th>Freight Ins</th>
		</tr>
		<tr>
			<td><input type="text" name="quantity" id="quantity" size="1"/></td>
			<td><input type="text" name="sku" id="sku" size="1"/></td>
			<td><input type="text" name="description" id="description"/></td>
			<td>
			<label>
			<select name="unittype" id="unittype"/>
				[% is_selected=0 %]
				[% FOREACH item IN packageunittype_loop %]
					[% is_selected=item.is_selected %]
						<option [% IF is_selected == 1 %] selected [% END %] value="[% item.value %]">[% item.name %]</option>
				[% END %]
			</select></label>
			</td>
			<td><input type="text" name="weight" id="weight" size="1"/></td>
			<td><input type="text" name="dimweight" id="dimweight" size="1"/></td>
			<td><input type="text" name="dimlength" id="dimlength" size="1"/></td>
			<td><input type="text" name="dimwidth" id="dimwidth" size="1"/></td>
			<td><input type="text" name="dimheight" id="dimheight" size="1"/></td>
			<td><input type="text" name="density" id="density" size="5"/></td>
			<td><input type="text" name="nmfc" id="nmfc" size="1"/></td>
			<td><input type="text" name="class1" id="class1" size="1"/></td>
			<td><input type="text" name="decval" id="decval" size="5"/></td>
			<td><input type="text" name="frtins" id="frtins" size="1"/></td>
		</tr>
		<tr>
			<td colspan=2><input type="button" class="submit rounded5" value="Add Package"/></td>
			<td><input type="button" class="submit rounded5" value="Add Product"/></td>
			<td colspan=3>
				Multiply Qty X Weight
				<input type="radio" name="quantityxweight" id="quantityxweighty" value="1"/><label for="quantityxweighty">Yes</label>
				<input type="radio" name="quantityxweight" id="quantityxweightn" value="0"/><label for="quantityxweightn">No</label>
			</td>
			<td colspan=3><label for="printpackinglist">Print Packing List:</label><input type="checkbox" name="printpackinglist" id="printpackinglist"/></td>
			<td colspan=5></td>
		</tr>
	</table>

	<h2>Special Services Requested</h2>
	<span class="require_text">Please check the appropriate boxes for any special services needed for this shipment.</span>
	<table class="app">
		[% count=0 %]
		<tr>
		[% FOREACH item IN specialservice_loop %]
		[% count=count+1 %]
			[% IF count == 5 %]
				</tr><tr>
			[% count = 0 %]
			[% ELSE %]
				<td>
				<input type="checkbox" name="[% item.value %]" id="[% item.value %]" value="[% item.value %]"/><label for="[% item.value %]">[% item.name %]</label>
				</td>
			[% END %]
		[% END %]
		</tr>
	</table>

	<div id="intlCommoditySec"></div>

	<table>
		<tr>
		<td>
		<table class="app">
			<caption>Carrier and Service Selection</caption>
			<tr>
				<td>
				<label for="deliverymethod">Delivery Method:</label><br/>
				<label>
				<select name="deliverymethod" id="deliverymethod">
					[% FOREACH item IN statelist_loop %]
						<option value="[% item.value %]">[% item.name %]</option>
					[% END %]
				</select>
				</label>
				</td>
				<td>
				<label for="freightcharges">Freight Charges:</label><br/>
				<label>
				<select name="freightcharges" id="freightcharges">
					[% FOREACH item IN statelist_loop %]
						<option value="[% item.value %]">[% item.name %]</option>
					[% END %]
				</select>
				</label>
				</td>
			</tr>
			<tr>
				<td><label for="account"><U>Account #:<U></label><br/><input type="text" name="account" id="account"/></td>
				<td><label for="tpcompanyname">Billing Company:</label><br/><input type="text" name="tpcompanyname" id="tpcompanyname"/></td>
			</tr>
			<tr>
				<td><label for="tpaddress1">Billing Address 1:</label><br/><input type="text" name="tpaddress1" id="tpaddress1"/></td>
				<td><label for="tpaddress2">Billing Address 2:</label><br/><input type="text" name="tpaddress2" id="tpaddress2"/></td>
			</tr>
			<tr>
				<td><label for="tpcity">Billing City:</label><br/><input type="text" name="tpcity" id="tpcity"/></td>
				<td><label for="tpstate">Billing State:</label><br/>
				<label>
				<select name="tpstate" id="tpstate">
					[% FOREACH item IN statelist_loop %]
						<option value="[% item.value %]">[% item.name %]</option>
					[% END %]
				</select>
				</label>
				</td>
			</tr>
			<tr>
				<td><label for="tpzip">Billing Zip:</label><br/><input type="text" name="tpzip" id="tpzip"/></td>
				<td><label for="tpcountry">Billing Country:</label><br/>
					<select name="tpcountry" id="tpcountry">
						[% FOREACH item IN countrylist_loop %]
								<option value="[% item.value %]">[% item.name %]</option>
						[% END %]
					</select>
				</td>
			</tr>
			<tr>
				<td>&nbsp;</td><td><input type="button" class="submit rounded5" value="Route"/></td>
			</tr>
		</table>
		</td>
		<td>
		<table class="app">
			<caption>Estimated Shipment Charges *</caption>
			<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
			<tr>
				<th>
				<label for="deliverymethod" class="float_right">Customer Quote:</label>
				</th>
				<th>
				<label>
				<select name="deliverymethod" id="deliverymethod">
					[% FOREACH item IN statelist_loop %]
						<option value="[% item.value %]">[% item.name %]</option>
					[% END %]
				</select>
				</label>
				</th>
			</tr>
			<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
			<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
			<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
			<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
			<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
			<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
			<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
			<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
			<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
			<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
			<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
		</table>
		</td>
		</tr>
	</table>

	<br/>

	<div class="float_right">
		<input type="submit" class="create rounded5" value="Save"/>
		<input type="button" class="review rounded5" value="Ship"/>
		<input type="button" class="cancel rounded5" value="Cancel"/>
	</div>

	</form>

<script>

function CalculateDensity()
	{
	var Weight = $("#weight").val();
	var Quantity = $("#quantity").val();
	var DimLength = $("#dimlength").val();
	var DimWidth = $("#dimwidth").val();
	var DimHeight = $("#dimheight").val();

	if ( DimLength > 0 && DimWidth > 0 && DimHeight > 0  && Weight > 0 && Quantity > 0)
		{
		var Density = (( (Weight/Quantity) / ( DimLength * DimWidth * DimHeight ) ) * 1728 );

		$("#density").val(Density);
		}
	}

$("#weight").blur(function() {
	CalculateDensity();
});

$("#quantity").blur(function() {
	CalculateDensity();
});

$("#dimlength").blur(function() {
	CalculateDensity();
});

$("#dimwidth").blur(function() {
	CalculateDensity();
});

$("#dimheight").blur(function() {
	CalculateDensity();
});

$("#sku").blur(function() {
	var sku_id=$("#sku").val();
	var dataString = 'ajax=1&do=get_sku_detail&sku_id='+ sku_id;

	$.ajax({
		type: "GET",
		url: "/customer/order/ajax", 
		data: dataString,
		contentType: "application/json; charset=utf-8",
		dataType: 'json',
		success: function(data) {
			if (data.error) {
				$("#description").val('');
				$("#weight").val('');
				$("#dimlength").val('');
				$("#dimwidth").val('');
				$("#dimheight").val('');
				$("#nmfc").val('');
				$("#class1").val('');
				$("#density").val('');
				$("#quantity").val('1');
			}
			else {
				$("#description").val(data.description);
				$("#weight").val(data.weight);
				$("#dimlength").val(data.length);
				$("#dimwidth").val(data.width);
				$("#dimheight").val(data.height);
				$("#nmfc").val(data.nmfc);
				$("#class1").val(data.class);
				$("#unittype option:selected").val(data.unittypeid);
			}
		},
		error: function(data) {
			alert("An internal error has occurred, Please contact support." + data);
		},
		complete: function(data){
			CalculateDensity();
		}
	})
});

function checkInternationalSection() {
	if($("#tocountry").val() != $("#fromcountry").val()) {
		send_ajax_request('intlCommoditySec', 'HTML', 'order', 'display_international', '', function (){
			$("#intlCommoditySec").slideDown(1000);
			});
		} else {
		$("#intlCommoditySec").slideUp("slow");
		$("#intlCommoditySec").empty();
		}
	}

$(document).ready(function(){

	$("#tophone").mask("999-999-9999");

	$("#fromzip").mask("99999");
	$("#tozip").mask("99999");

	$("#shipon").datepicker("setDate", new Date());

	var availableCustomers = [
		[% FOREACH item IN customerlist_loop %]
			"[% item.name %]",
		[% END %]
		];

	$("#toname").autocomplete({
		source: availableCustomers
		});

	$("#tocountry").change(function() {
		checkInternationalSection();
		});

	$("#frm_order").submit(function() {

		var requireHash = {
				fromdepartment: { minlength: 2 },
				fromcontact   : { phone: true },
				fromemail     : { email: true },
				toname        : { minlength: 2 },
				toaddress1    : { minlength: 2 },
				tocity        : { minlength: 2 },
				tostate       : { minlength: 2 },
				tozip         : { minlength: 5 },
				tocountry     : { minlength: 2 },
				tocontact     : { minlength: 2 },
				tophone       : { phone: true },
				toemail       : { email: true }
				};

		return validateForm(requireHash);
		});

	checkInternationalSection();
	});

</script>
